Tool/Model Summary Template: Partis (Simulation & Modeling Details)

1. Tool/Model Name:
Partis

2. Reference(s):
- Ralph DK, Matsen FA IV (2016) Likelihood-Based Inference of B Cell Clonal Families. PLoS Comput Biol 12(10): e1005086. doi:10.1371/journal.pcbi.1005086
- Ralph DK, Matsen FA IV (2016) Consistency of VDJ Rearrangement and Substitution Parameters Enables Accurate B Cell Receptor Sequence Annotation. PLoS Comput Biol 12(1): e1004409. doi:10.1371/journal.pcbi.1004409
- GitHub: https://github.com/psathyrella/partis

3. Category:
VDJ Annotation, Clonal Family Inference, BCR Simulation, Hidden Markov Model (HMM) Framework

4. Main Purpose/Function:
To accurately annotate B cell receptor (BCR) sequences and infer clonal families using likelihood-based models, and to validate these methods using realistic simulations of BCR generation and evolution.

5. Key Features (Simulation/Modeling Focus):
- Realistic simulation of BCR generation and evolution
- Empirically derived parameter distributions for VDJ recombination and SHM
- Models clonal family structure and size
- Incorporates indel mutations (limited)
- Provides ground truth for benchmarking

6. Input Requirements (Simulation):
- Germline V, D, J gene sets
- Empirical distributions for deletion lengths, N-region lengths, mutation rates
- Parameters for clonal family size distributions (geometric, Zipf)

7. Output (Simulation):
- Simulated BCR sequences with known VDJ origin, clonal family, and naive sequence
- Datasets for benchmarking annotation and clustering methods

8. Validation/Evaluation:
- Simulated datasets used to benchmark Partis and other tools
- Metrics: precision, sensitivity, F1 score, Hamming distance
- Comparison to real data for plausibility

9. Strengths (Simulation/Modeling):
- Captures key biological processes (VDJ recombination, SHM, clonal expansion)
- Parameter-rich, data-driven modeling
- Enables rigorous benchmarking with known ground truth

10. Limitations (Simulation/Modeling):
- Does not model sequencing errors or platform-specific biases
- Limited modeling of complex rearrangement events (e.g., palindromic N-additions, tandem D segments)
- Indel modeling is heuristic and limited

11. Applications in Autoimmunity:
- Simulations can be adapted to model BCR repertoires in autoimmune disease
- Useful for benchmarking tools in the context of autoimmunity research

12. Notable Citations/Use Cases:
- Used to validate Partis against other BCR annotation and clustering tools
- Referenced in studies of HIV broadly neutralizing antibodies and vaccine development

13. Reviewerâ€™s Comments (Simulation/Modeling Focus):
The simulation framework in Partis is a major strength, enabling robust validation of annotation and clonal inference methods. By modeling VDJ recombination, somatic hypermutation, and clonal expansion with empirically derived parameters, the simulations closely mimic real BCR repertoire data. The main limitations are the lack of sequencing error modeling and only partial handling of complex rearrangement events. Overall, the approach provides a strong foundation for benchmarking and method development.

---

Detailed Simulation/Modeling Aspects:

A. VDJ Recombination Modeling:
- Random selection of V, D, and J genes from germline sets
- Random exonuclease trimming (deletion) at gene segment ends
- Addition of random non-templated (N) nucleotides at junctions
- Distributions for these events are empirically derived and can vary by gene/allele

B. Somatic Hypermutation (SHM) Modeling:
- Point mutations introduced into naive BCR sequences
- Mutation rates vary by position and allele, based on empirical data

C. Clonal Expansion and Family Structure:
- Simulated lineages generated by mutating naive sequences
- Clonal family sizes modeled using geometric or Zipf (power-law) distributions

D. Sequence Sampling:
- Simulated datasets range from thousands to millions of sequences
- Both typical and high-mutation scenarios are simulated

E. Indel Mutation Modeling:
- Some simulations include insertions/deletions, especially in V region or CDR3
- Indels introduced heuristically; performance measured in their presence

F. What is NOT Modeled:
- Sequencing errors (PCR/platform-specific) are not simulated
- Complex rearrangement events (palindromic N-additions, tandem D segments) not fully modeled
- Platform-specific biases not included

G. Validation Metrics:
- Precision, sensitivity, F1 score for clustering
- Hamming distance for naive sequence inference
- Cluster size distribution comparison

H. Summary Table:
| Process                | Modeled? | Details                                                                 |
|------------------------|----------|-------------------------------------------------------------------------|
| VDJ recombination      | Yes      | Random gene choice, trimming, N-addition, empirical distributions       |
| Somatic hypermutation  | Yes      | Point mutations, position/allele-specific rates                         |
| Clonal expansion       | Yes      | Family size/structure, geometric/Zipf distributions                     |
| Indels                 | Limited  | Heuristic, mainly in V/CDR3 regions                                     |
| Sequencing error       | No       | Not included                                                            |
| Platform bias          | No       | Not included                                                            | 